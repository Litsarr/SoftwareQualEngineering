<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart</title>
  <link rel="stylesheet" href="cart.css">
</head>
<body>
  <div class="cart-container">
    <h1>Shopping Cart</h1>
    <div id="cart-items" class="cart-items">
      <!-- Cart items will be dynamically rendered here -->
    </div>

    <div class="cart-summary">
      <p>Total Amount: <span id="total-amount">₱0</span></p>
      <!-- The checkout button is initially disabled -->
      <button id="checkout-btn" class="checkout-btn" disabled>
        <a id="checkout-link" href="Checkout.html" style="pointer-events: none;">Checkout</a>
      </button>
      <button onclick="clearCart()" class="clear-cart-btn">Clear Cart</button>
    </div>
  </div>

  <script>
    // Dummy data for cart items (fetch from localStorage in a real scenario)
    const cart = JSON.parse(localStorage.getItem('cart')) || [
      { name: 'Product 1', price: 450, image: 'img/products/classics/islander-black.webp', quantity: 1 },
      // Add more items here if needed
    ];

    // Function to render cart items
    function renderCart() {
      const cartItemsContainer = document.getElementById('cart-items');
      cartItemsContainer.innerHTML = ''; // Clear previous content

      if (cart.length === 0) {
        cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
        document.getElementById('total-amount').innerText = '₱0';
        return;
      }

      let totalAmount = 0;

      cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        totalAmount += itemTotal;

        const itemHTML = `
          <div class="cart-item">
            <input type="checkbox" class="item-checkbox" onchange="updateCheckoutButton()">
            <img src="${item.image}" alt="Product Image" class="item-image">
            <span class="item-name">${item.name}</span>
            <span class="item-price" data-price="${item.price}">₱${item.price}</span>
            <div class="quantity-controls">
              <button class="decrease-btn" onclick="updateQuantity(${index}, -1)">-</button>
              <input type="number" class="quantity" value="${item.quantity}" min="1" onchange="updateQuantity(${index}, this.value - cart[${index}].quantity)">
              <button class="increase-btn" onclick="updateQuantity(${index}, 1)">+</button>
            </div>
            <button class="delete-btn" onclick="removeItem(${index})">Delete</button>  
          </div>
        `;
        cartItemsContainer.innerHTML += itemHTML;
      });

      document.getElementById('total-amount').innerText = `₱${totalAmount}`;
    }

    // Function to update the checkout button's state
    function updateCheckoutButton() {
      const checkboxes = document.querySelectorAll('.item-checkbox');
      const isAnyChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);
      const checkoutButton = document.getElementById('checkout-btn');
      const checkoutLink = document.getElementById('checkout-link');

      // Enable or disable the button and link based on checkboxes
      if (isAnyChecked) {
        checkoutButton.disabled = false;
        checkoutLink.style.pointerEvents = 'auto';
      } else {
        checkoutButton.disabled = true;
        checkoutLink.style.pointerEvents = 'none';
      }
    }

    // Function to clear the cart
    function clearCart() {
      localStorage.removeItem('cart'); // Clear from localStorage
      cart.length = 0; // Clear the local cart array
      alert('Cart cleared!');
      renderCart(); // Update the UI
      updateCheckoutButton(); // Ensure the button is updated
    }

    // Function to update quantity
    function updateQuantity(index, change) {
      cart[index].quantity += change;
      if (cart[index].quantity < 1) cart[index].quantity = 1;
      localStorage.setItem('cart', JSON.stringify(cart)); // Update localStorage
      renderCart(); // Re-render the cart
      updateCheckoutButton(); // Ensure the button is updated
    }

    // Function to remove an item
    function removeItem(index) {
      cart.splice(index, 1);
      localStorage.setItem('cart', JSON.stringify(cart)); // Update localStorage
      renderCart(); // Re-render the cart
      updateCheckoutButton(); // Ensure the button is updated
    }

    // Initial rendering of the cart
    renderCart();
    updateCheckoutButton();
  </script>
</body>
</html>
